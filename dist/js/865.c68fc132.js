"use strict";(self["webpackChunkhm_shopping"]=self["webpackChunkhm_shopping"]||[]).push([[865],{865:function(t,s,a){a.r(s),a.d(s,{default:function(){return m}});a(4114);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"prodetail"},[s("van-nav-bar",{attrs:{fixed:"",title:"商品详情","left-arrow":""},on:{"click-left":function(s){return t.$router.back()}}}),s("van-swipe",{attrs:{autoplay:3e3},on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[s("div",{staticClass:"custom-indicator"},[t._v(" "+t._s(t.currIndex+1)+" / "+t._s(t.images.length)+" ")])]},proxy:!0}])},t._l(t.images,(function(t){return s("van-swipe-item",{key:t.file_id},[s("img",{attrs:{src:t.external_url,title:t.file_name,alt:t.file_name}})])})),1),s("div",{staticClass:"info"},[s("div",{staticClass:"title"},[s("div",{staticClass:"price"},[s("span",{staticClass:"now"},[t._v("￥"+t._s(t.detail.goods_price_min))]),s("span",{staticClass:"oldprice"},[t._v("￥"+t._s(t.detail.goods_price_max))])]),s("div",{staticClass:"sellcount"},[t._v("已售"+t._s(t.detail.goods_sales)+"件")])]),s("div",{staticClass:"msg text-ellipsis-2",domProps:{innerHTML:t._s(t.detail.goods_name)}}),s("div",{staticClass:"service"},[s("div",{staticClass:"left-words"},t._l(t.service,(function(a){return s("span",{key:a.service_id,attrs:{title:a.summary}},[s("van-icon",{attrs:{name:"passed"}}),t._v(" "+t._s(a.name)+" ")],1)})),0),s("div",{staticClass:"right-icon"},[s("van-icon",{attrs:{name:"arrow"}})],1)])]),s("div",{staticClass:"comment"},[s("div",{staticClass:"comment-title"},[s("div",{staticClass:"left"},[t._v(" 商品评价 ("+t._s(t.comment.total)+"条) ")]),s("div",{staticClass:"right"},[t._v(" 查看更多 "),s("van-icon",{attrs:{name:"arrow"}})],1)]),s("div",{staticClass:"comment-list"},t._l(t.comment.list,(function(a){return s("div",{key:a.comment_id,staticClass:"comment-item"},[s("div",{staticClass:"top"},[s("img",{attrs:{src:a.user.avatar_url}}),s("div",{staticClass:"name",domProps:{innerHTML:t._s(a.user.nick_name)}}),s("van-rate",{attrs:{size:16,value:Math.floor(5*Math.random()),color:"#ffd21e","void-icon":"star","void-color":"#eee"}})],1),s("div",{staticClass:"content",domProps:{innerHTML:t._s(a.content)}}),s("div",{staticClass:"time",domProps:{innerHTML:t._s(a.create_time)}})])})),0)]),t._m(0),s("div",{staticClass:"footer"},[s("div",{staticClass:"icon-home",on:{click:function(s){return t.$router.push("/")}}},[s("van-icon",{attrs:{name:"wap-home-o"}}),s("span",[t._v("首页")])],1),s("div",{staticClass:"icon-cart"},[t.cartTotal?s("span",{staticClass:"num",domProps:{innerHTML:t._s(t.cartTotal)}}):t._e(),s("van-icon",{attrs:{name:"shopping-cart-o"}}),s("span",[t._v("购物车")])],1),s("div",{staticClass:"btn-add",on:{click:function(s){return t.pannel("cart")}}},[t._v("加入购物车")]),s("div",{staticClass:"btn-buy",on:{click:function(s){return t.pannel("buy")}}},[t._v("立刻购买")])]),s("van-action-sheet",{attrs:{title:"cart"===t.mode?"加入购物车":"立刻购买"},model:{value:t.showPannel,callback:function(s){t.showPannel=s},expression:"showPannel"}},[s("div",{staticClass:"product"},[s("div",{staticClass:"product-title"},[s("div",{staticClass:"left"},[s("img",{attrs:{src:t.detail.goods_image,alt:""}})]),s("div",{staticClass:"right"},[s("div",{staticClass:"price"},[s("span",[t._v("¥")]),s("span",{staticClass:"nowprice",domProps:{innerHTML:t._s(t.detail.goods_price_min)}})]),s("div",{staticClass:"count"},[s("span",[t._v("库存")]),s("span",{domProps:{innerHTML:t._s(t.detail.stock_total)}})])])]),s("div",{staticClass:"num-box"},[s("span",[t._v("数量")]),s("van-stepper",{attrs:{disabled:0===t.detail.stock_total},model:{value:t.count,callback:function(s){t.count=s},expression:"count"}})],1),t.detail.stock_total?s("div",{staticClass:"showbtn"},["cart"===t.mode?s("div",{staticClass:"btn",on:{click:t.loginAuthOptions}},[t._v("加入购物车")]):s("div",{staticClass:"btn now",on:{click:t.loginAuthOptions}},[t._v("立刻购买")])]):s("div",{staticClass:"btn-none"},[t._v("该商品已抢完")])])])],1)},o=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"desc"},[s("img",{attrs:{src:"https://uimgproxy.suning.cn/uimg1/sop/commodity/kHgx21fZMWwqirkMhawkAw.jpg",alt:""}}),s("img",{attrs:{src:"https://uimgproxy.suning.cn/uimg1/sop/commodity/0rRMmncfF0kGjuK5cvLolg.jpg",alt:""}}),s("img",{attrs:{src:"https://uimgproxy.suning.cn/uimg1/sop/commodity/2P04A4Jn0HKxbKYSHc17kw.jpg",alt:""}}),s("img",{attrs:{src:"https://uimgproxy.suning.cn/uimg1/sop/commodity/MT4k-mPd0veQXWPPO5yTIw.jpg",alt:""}})])}],e=a(7867),n=a(9652),c={name:"ProDetail",data(){return{detail:{},images:[],comment:[],service:[],currIndex:0,mode:"cart",showPannel:!1,count:1,cartTotal:0}},computed:{totalPrice(){return this.count*this.detail.goods_price_min}},methods:{onChange(t){this.currIndex=t},pannel(t){this.mode=t,this.showPannel=!0},async addCart(){const t=await n.V.addCart(this.goodsId,this.count,this.detail.skuList[0].goods_sku_id);this.$toast.success("添加成功"),this.showPannel=!1,this.cartTotal=t.data.cartTotal},goBuyNow(){this.$router.push({path:"/pay",query:{mode:"buyNow",data:{title:this.detail.goods_name,image:this.detail.goods_image,count:this.count,price:this.detail.goods_price_min,total:this.count,totalPrice:this.totalPrice,info:{goodsId:String(this.detail.goods_id),goodsNum:this.count,goodsSkuId:this.detail.skuList[0].goods_sku_id}}}})},async loginAuthOptions(){const t=this.$store.state.user.userInfo.token;t?"cart"===this.mode?this.addCart():this.goBuyNow():this.$confirm(this.$route.fullPath,(()=>{this.showPannel=!1}))}},async created(){this.goodsId=this.$route.params.id;const t=await e._.getDetail(this.goodsId);this.detail=t.data.detail,this.images=t.data.detail.goods_images;const s=await e._.getComment(this.goodsId);this.comment=s.data,this.cartTotal=(await n.V.getTotal()).data.cartTotal,this.service=(await e._.getService(this.goodsId)).data.list}},r=c,l=a(1656),d=(0,l.A)(r,i,o,!1,null,"4d1d28f5",null),m=d.exports},7867:function(t,s,a){a.d(s,{_:function(){return o}});var i=a(935);const o={getList(t,s){return(0,i.A)({method:"GET",url:"/goods/list",query:{sortType:s,categoryId:"0",goodsName:t,page:1}})},getDetail(t){return(0,i.A)({method:"GET",url:"/goods/detail",params:{goodsId:t}})},getComment(t,s=5){return(0,i.A)({method:"GET",url:"/comment/listRows",params:{goodsId:t,limit:s}})},getService(t){return(0,i.A)({method:"GET",url:"/goods.service/list",params:{goodsId:t}})}}}}]);
//# sourceMappingURL=865.c68fc132.js.map