"use strict";(self["webpackChunkhm_shopping"]=self["webpackChunkhm_shopping"]||[]).push([[166],{9166:function(s,t,a){a.r(t),a.d(t,{default:function(){return h}});var e=function(){var s=this,t=s._self._c;return t("div",{staticClass:"pay"},[t("van-nav-bar",{attrs:{fixed:"",title:"订单结算台","left-arrow":""},on:{"click-left":function(t){return s.$router.back()}}}),t("div",{staticClass:"address",on:{click:function(t){s.showPannel=!0}}},[t("div",{staticClass:"left-icon"},[t("van-icon",{attrs:{name:"logistics"}})],1),-1!==s.currIndex?t("div",{staticClass:"info"},[t("div",{staticClass:"info-content"},[t("span",{staticClass:"name",domProps:{innerHTML:s._s(s.address.name)}}),t("span",{staticClass:"mobile",domProps:{innerHTML:s._s(s.address.phone)}})]),t("div",{staticClass:"info-address",domProps:{innerHTML:s._s(s.getRegion(s.address))}})]):t("div",{staticClass:"info"},[s._v("请选择配送地址")]),t("div",{staticClass:"right-icon"},[t("van-icon",{attrs:{name:"arrow"}})],1)]),t("van-action-sheet",{model:{value:s.showPannel,callback:function(t){s.showPannel=t},expression:"showPannel"}},[t("div",{staticClass:"info",on:{click:s.addAddress}},[s._v(" 添加新地址 "),t("van-icon",{attrs:{name:"add-o"}})],1),s._l(s.addressList,(function(a,e){return t("div",{key:a.address_id,staticClass:"info",on:{click:function(t){return s.chooseAddress(e)}}},[t("div",{staticClass:"left-icon"},[t("van-icon",{attrs:{name:"logistics"}})],1),t("div",{staticClass:"info-content"},[t("div",{},[t("span",{staticClass:"name",domProps:{innerHTML:s._s(a.name)}}),t("span",{staticClass:"mobile",domProps:{innerHTML:s._s(a.phone)}})]),t("div",{staticClass:"info-address",domProps:{innerHTML:s._s(s.getRegion(a))}})]),t("div",{staticClass:"right-icon",on:{click:function(t){return s.delAddress(t,a.address_id)}}},[t("van-icon",{attrs:{name:"delete-o"}})],1)])}))],2),t("div",{staticClass:"pay-list"},[t("div",{staticClass:"list"},[t("div",{staticClass:"goods-item"},[t("div",{staticClass:"left"},[t("img",{attrs:{src:s.image,alt:""}})]),t("div",{staticClass:"right"},[t("p",{staticClass:"tit text-ellipsis-2",domProps:{textContent:s._s(s.title)}}),t("p",{staticClass:"info"},[t("span",{staticClass:"count"},[s._v("x"+s._s(s.count))]),t("span",{staticClass:"price"},[s._v("¥"+s._s(s.price))])])])])]),t("div",{staticClass:"flow-num-box"},[t("span",[s._v("共 "+s._s(s.total)+" 件商品，合计：")]),t("span",{staticClass:"money"},[s._v("￥"+s._s(s.totalPrice))])]),t("div",{staticClass:"pay-detail"},[t("div",{staticClass:"pay-cell"},[t("span",[s._v("订单总金额：")]),t("span",{staticClass:"red"},[s._v("￥"+s._s(s.totalPrice))])]),s._m(0),t("div",{staticClass:"pay-cell"},[t("span",[s._v("配送费用：")]),t("span",{staticClass:"red"},[s._v("+￥0.00")])])]),t("div",{staticClass:"pay-way"},[t("span",{staticClass:"tit"},[s._v("支付方式")]),t("div",{staticClass:"pay-cell"},[t("span",[t("van-icon",{attrs:{name:"balance-o"}}),s._v("余额支付（可用 ¥ "+s._s(s.assets.balance||0)+" 元）")],1),t("span",{staticClass:"red"},[t("van-icon",{attrs:{name:"passed"}})],1)])]),t("div",{staticClass:"buytips"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:s.remark,expression:"remark"}],attrs:{placeholder:"选填：买家留言（50字内）",cols:"30",rows:"10"},domProps:{value:s.remark},on:{input:function(t){t.target.composing||(s.remark=t.target.value)}}})])]),t("div",{staticClass:"footer-fixed"},[t("div",{staticClass:"left"},[s._v("实付款："),t("span",[s._v("￥"+s._s(s.totalPrice))])]),t("div",{staticClass:"tipsbtn",on:{click:s.checkPay}},[s._v("提交订单")])])],1)},i=[function(){var s=this,t=s._self._c;return t("div",{staticClass:"pay-cell"},[t("span",[s._v("优惠券：")]),t("span",[s._v("无优惠券可用")])])}],n=a(935);const r={getList(){return n.A.get("/address/list")},add(){return n.A.post("/address/add",{form:{name:"杨天乐",phone:"18230712114",region:[{value:"782",label:"上海"},{value:"783",label:"上海市"},{value:"785",label:"徐汇区"}],detail:"贵州师范大学一栋"}})},delete(s){return n.A.post("/address/remove",{addressId:s})}};var c=a(3518);const d={pay(s){return(0,n.A)({method:"POST",url:"/checkout/submit",data:s})}};var o=a(2549),l={name:"PayIndex",data(){return{remark:"",assets:{},showPannel:!1,currIndex:0,addressList:[]}},computed:{...(0,c.aH)("cart",["cartTotal"]),...(0,c.L8)("cart",["selCount","selPrice"]),prod(){return this.$store.getters["cart/selCartList"][0]},address(){return-1===this.currIndex?{}:this.addressList[this.currIndex]}},methods:{async getList(){const s=await r.getList();this.addressList=s.data.list,0===this.addressList.length&&(this.currIndex=-1)},chooseAddress(s){this.currIndex=s,this.showPannel=!1},getRegion(s){const t=s.region;return t.province+" "+t.city+" "+t.region+" "+s.detail},async addAddress(){const s=await r.add();await this.getList(),this.$toast.success(s.message)},async delAddress(s,t){s.stopPropagation();const a=await r.delete(t);await this.getList(),this.$toast.success(a.message)},async checkPay(){if(-1===this.currIndex)return void this.$toast.fail("请先选择收货地址");const s=this.info||{};await d.pay({...s,delivery:10,couponId:0,isUsePoints:0,mode:this.$route.query.mode,payType:10,remark:this.remark}),this.$toast.success("支付成功"),this.$router.back()}},beforeCreate(){Object.assign(this,this.$route.query.data)},async created(){this.addressList=(await r.getList()).data.list,this.assets=(await o.O.getAssets()).data.assets}},v=l,p=a(1656),u=(0,p.A)(v,e,i,!1,null,"3dbcb1fa",null),h=u.exports}}]);
//# sourceMappingURL=166.109d7096.js.map